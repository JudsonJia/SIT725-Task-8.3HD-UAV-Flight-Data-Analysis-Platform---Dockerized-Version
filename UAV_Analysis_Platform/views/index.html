<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>UAV Analysis Platform</title>
    <meta name="description" content="UAV flight data analysis and visualization platform">
    <meta name="author" content="UAV Research Team">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Material Symbols for Drone Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=drone" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=drone_2" />
    <!-- Custom Style Sheet-->
    <link rel="stylesheet" href="../public/css/styles.css">
</head>
<body>
<!-- Navigation -->
<nav class="teal darken-2" role="navigation" aria-label="Main navigation">
    <div class="nav-wrapper navbar-size">
        <a href="#" class="brand-logo" aria-label="UAV Analysis Platform Home">
            <span class="material-symbols-outlined" style="font-size: 2rem; margin-right: 10px;" aria-hidden="true">drone</span>UAV Analysis
        </a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
            <!-- Navigation items will be dynamically populated by JavaScript -->
        </ul>
    </div>
</nav>

<!-- Main Content -->
<main class="main-body" role="main">
    <div class="container">
        <!-- Hero Section -->
        <section class="row" aria-labelledby="hero-heading">
            <div class="col s12 center-align hero-section">
                <h1 id="hero-heading">UAV Flight Data Analysis Platform</h1>
                <p class="flow-text">
                    Professional flight data processing and analysis tools for UAV performance evaluation.
                    Upload your flight data, analyze trajectory patterns, and visualize results in interactive 3D.
                </p>
                <div class="hero-image center-align" aria-hidden="true">
                    <span class="material-symbols-outlined" style="font-size: 8rem; color: #333; margin: 30px 0; animation: float 3s ease-in-out infinite;">drone_2</span>
                </div>
                <a href="#" id="dashboard-btn" class="waves-effect waves-light btn-large teal" aria-describedby="start-description" style="display: none;">
                    <i class="material-icons left" aria-hidden="true">dashboard</i>Go to Dashboard
                </a>
                <a href="/login" id="login-btn" class="waves-effect waves-light btn-large teal" aria-describedby="login-description">
                    <i class="material-icons left" aria-hidden="true">login</i>Login to Continue
                </a>
                <p id="start-description" class="sr-only">Access the main dashboard to manage your flight data</p>
                <p id="login-description" class="sr-only">Login to access the platform features</p>
            </div>
        </section>

        <!-- Feature Cards -->
        <section class="row" id="feature-section" aria-labelledby="features-heading">
            <div class="col s12 center-align">
                <h2 id="features-heading" class="section-title">Platform Features</h2>
            </div>
        </section>
        <div class="row" id="card-section">
            <div class="col s12 m6 l4">
                <div class="card feature-card">
                    <div class="card-content">
                        <span class="card-title">
                            <i class="material-icons left" aria-hidden="true">flight_takeoff</i>Flight Data Management
                        </span>
                        <p>Upload and organize your UAV flight data with comprehensive validation and error detection.</p>
                    </div>
                </div>
            </div>
            <div class="col s12 m6 l4">
                <div class="card feature-card">
                    <div class="card-content">
                        <span class="card-title">
                            <i class="material-icons left" aria-hidden="true">analytics</i>Performance Analysis
                        </span>
                        <p>Detailed trajectory analysis including accuracy metrics, path efficiency, and flight statistics.</p>
                    </div>
                </div>
            </div>
            <div class="col s12 m6 l4">
                <div class="card feature-card">
                    <div class="card-content">
                        <span class="card-title">
                            <i class="material-icons left" aria-hidden="true">3d_rotation</i>3D Visualization
                        </span>
                        <p>Interactive 3D trajectory visualization with error indicators and flight path reconstruction.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Getting Started Section -->
        <section class="row" id="getting-started" aria-labelledby="start-heading">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title" id="start-heading">
                            <i class="material-icons left" aria-hidden="true">rocket_launch</i>Getting Started
                        </span>
                        <div class="row">
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons large teal-text">person_add</i>
                                    <h5>1. Create Account</h5>
                                    <p>Register for a new account to access all platform features</p>
                                    <a href="/register" id="register-step-btn" class="btn teal">Register Now</a>
                                    <a href="#" id="dashboard-step-btn" class="btn teal" style="display: none;">Go to Dashboard</a>
                                </div>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons large orange-text">upload_file</i>
                                    <h5>2. Upload Data</h5>
                                    <p>Upload your JSON flight data files through the dashboard</p>
                                    <a href="/login" id="upload-step-btn" class="btn orange disabled">Login Required</a>
                                </div>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons large green-text">bar_chart</i>
                                    <h5>3. Analyze Results</h5>
                                    <p>View detailed analysis and performance metrics</p>
                                    <a href="/login" id="analysis-step-btn" class="btn green disabled">Login Required</a>
                                </div>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons large purple-text">3d_rotation</i>
                                    <h5>4. Visualization</h5>
                                    <p>Interactive 3D trajectory visualization and playback</p>
                                    <a href="/login" id="visualization-step-btn" class="btn purple disabled">Login Required</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section class="row" id="about" aria-labelledby="about-heading">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title" id="about-heading">
                            <i class="material-icons left" aria-hidden="true">info</i>About the Platform
                        </span>
                        <p>
                            This UAV Analysis Platform provides comprehensive tools for processing and analyzing unmanned aerial vehicle flight data.
                            The platform supports JSON data format and offers detailed trajectory analysis, accuracy measurements,
                            and interactive 3D visualizations to help researchers and engineers understand UAV performance characteristics.
                        </p>
                        <div class="row">
                            <div class="col s12 m6">
                                <h6><i class="material-icons tiny">check</i> Supported Features:</h6>
                                <ul>
                                    <li>JSON flight data processing</li>
                                    <li>Trajectory accuracy analysis</li>
                                    <li>Interactive 3D visualization</li>
                                    <li>Performance metrics calculation</li>
                                    <li>Flight data management</li>
                                </ul>
                            </div>
                            <div class="col s12 m6">
                                <h6><i class="material-icons tiny">storage</i> Data Requirements:</h6>
                                <ul>
                                    <li>JSON format with position data</li>
                                    <li>Timestamp information</li>
                                    <li>X, Y, Z coordinates</li>
                                    <li>Optional: target positions</li>
                                    <li>Optional: phase information</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="js/scripts.js"></script>

<script>
    // Check authentication status and update UI accordingly
    function checkAuthStatus() {
        const token = localStorage.getItem('uav_token');
        const navMobile = document.getElementById('nav-mobile');
        const dashboardBtn = document.getElementById('dashboard-btn');
        const loginBtn = document.getElementById('login-btn');

        // Getting started section buttons
        const registerStepBtn = document.getElementById('register-step-btn');
        const dashboardStepBtn = document.getElementById('dashboard-step-btn');
        const uploadStepBtn = document.getElementById('upload-step-btn');
        const analysisStepBtn = document.getElementById('analysis-step-btn');
        const visualizationStepBtn = document.getElementById('visualization-step-btn');

        if (token) {
            // User is logged in
            navMobile.innerHTML = `
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/flights">Flights</a></li>
                <li><a href="/analysis">Analysis</a></li>
                <li><a href="javascript:void(0);" onclick="logout()">Logout</a></li>
            `;

            // Show dashboard button, hide login button
            dashboardBtn.style.display = 'inline-block';
            dashboardBtn.href = '/dashboard';
            loginBtn.style.display = 'none';

            // Update getting started section for logged in users
            if (registerStepBtn) registerStepBtn.style.display = 'none';
            if (dashboardStepBtn) {
                dashboardStepBtn.style.display = 'inline-block';
                dashboardStepBtn.href = '/dashboard';
            }
            if (uploadStepBtn) {
                uploadStepBtn.textContent = 'Go to Dashboard';
                uploadStepBtn.href = '/dashboard';
                uploadStepBtn.classList.remove('disabled');
                uploadStepBtn.classList.add('orange');
            }
            if (analysisStepBtn) {
                analysisStepBtn.textContent = 'View Analysis';
                analysisStepBtn.href = '/analysis';
                analysisStepBtn.classList.remove('disabled');
                analysisStepBtn.classList.add('green');
            }
            if (visualizationStepBtn) {
                visualizationStepBtn.textContent = 'View Visualization';
                visualizationStepBtn.href = '/visualization';
                visualizationStepBtn.classList.remove('disabled');
                visualizationStepBtn.classList.add('purple');
            }
        } else {
            // User is not logged in
            navMobile.innerHTML = `
                <li><a href="/dashboard" onclick="requireLogin(event)">Dashboard</a></li>
                <li><a href="/login">Login</a></li>
                <li><a href="/register">Register</a></li>
            `;

            // Show login button, hide dashboard button
            dashboardBtn.style.display = 'none';
            loginBtn.style.display = 'inline-block';
        }
    }

    // Logout function
    function logout() {
        localStorage.removeItem('uav_token');
        localStorage.removeItem('token_timestamp');
        M.toast({ html: 'Logged out successfully', classes: 'green' });

        // Refresh the page to update UI
        setTimeout(() => {
            window.location.reload();
        }, 1000);
    }

    // Require login function for protected routes
    function requireLogin(event) {
        event.preventDefault();
        M.toast({ html: 'Please login to access the dashboard', classes: 'orange' });
        setTimeout(() => {
            window.location.href = '/login';
        }, 1500);
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        checkAuthStatus();

        // Initialize Materialize components
        M.AutoInit();
    });
</script>
</body>
</html>